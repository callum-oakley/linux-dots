#!/usr/bin/env zsh

# from `aws iam list-mfa-devices --user-name callum`
mfa=arn:aws:iam::112622444253:mfa/callum
creds="$(aws sts get-session-token --serial-number $mfa --token-code $1)"
export AWS_ACCESS_KEY_ID=$(printf "%s" "$creds" | jq -r .Credentials.AccessKeyId)
export AWS_SECRET_ACCESS_KEY=$(printf "%s" "$creds" | jq -r .Credentials.SecretAccessKey)
export AWS_SESSION_TOKEN=$(printf "%s" "$creds" | jq -r .Credentials.SessionToken)
